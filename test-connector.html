<!DOCTYPE html>
<html>
<head>
    <title>Connector Test</title>
    <style>
        body { margin: 0; padding: 20px; font-family: Arial; }
        .info { margin-bottom: 20px; padding: 10px; background: #f0f0f0; border-radius: 5px; }
        .test-btn { padding: 10px 20px; margin: 5px; cursor: pointer; background: #4F46E5; color: white; border: none; border-radius: 5px; }
        .test-btn:hover { background: #3730A3; }
        #results { margin-top: 20px; padding: 10px; background: #e8f5e9; border-radius: 5px; }
        .error { background: #ffebee; }
        .success { background: #e8f5e9; }
    </style>
</head>
<body>
    <div class="info">
        <h2>Connector Tool Test</h2>
        <p>This test verifies:</p>
        <ul>
            <li>ConnectorService initialization</li>
            <li>Anchor snapping with 12px threshold</li>
            <li>Live routing when elements move</li>
            <li>Line and Arrow tool activation</li>
        </ul>
    </div>

    <button class="test-btn" onclick="testConnectorService()">Test ConnectorService</button>
    <button class="test-btn" onclick="testAnchorSnapping()">Test Anchor Snapping</button>
    <button class="test-btn" onclick="testLiveRouting()">Test Live Routing</button>
    <button class="test-btn" onclick="testTools()">Test Line/Arrow Tools</button>

    <div id="results"></div>

    <script>
        function log(message, isError = false) {
            const results = document.getElementById('results');
            results.className = isError ? 'error' : 'success';
            results.innerHTML += message + '<br>';
        }

        function testConnectorService() {
            try {
                // Check if ConnectorService is available globally
                if (window.connectorService) {
                    log('✓ ConnectorService is initialized and available globally');
                } else {
                    log('✗ ConnectorService not found. Make sure Canvas is loaded.', true);
                }
            } catch (e) {
                log('✗ Error: ' + e.message, true);
            }
        }

        function testAnchorSnapping() {
            try {
                log('Testing anchor snapping...');
                // This would need the canvas to be running
                log('Note: Open the Canvas app and try drawing a connector near an element to test snapping');
            } catch (e) {
                log('✗ Error: ' + e.message, true);
            }
        }

        function testLiveRouting() {
            try {
                log('Testing live routing...');
                log('Note: Create a connector between two elements, then drag one element to see live updates');
            } catch (e) {
                log('✗ Error: ' + e.message, true);
            }
        }

        function testTools() {
            try {
                // Check if stage and layers are available
                if (window.canvasStage && window.canvasLayers) {
                    log('✓ Stage and layers are available globally');
                    log('✓ Line and Arrow tools can access required resources');
                } else {
                    log('✗ Stage/layers not found. Make sure Canvas is loaded.', true);
                }
            } catch (e) {
                log('✗ Error: ' + e.message, true);
            }
        }

        // Clear results on page load
        document.getElementById('results').innerHTML = 'Click buttons to run tests...';
    </script>
</body>
</html>